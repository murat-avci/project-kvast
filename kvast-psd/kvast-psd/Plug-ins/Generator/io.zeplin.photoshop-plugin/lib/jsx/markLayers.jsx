function renameLayer(e,r,a,n){deselectLayers(),selectLayer(e),renameActiveLayer(determineNewName(r,a,n))}function addToSelection(e){var r=charIDToTypeID("slct"),a=new ActionDescriptor,n=charIDToTypeID("null"),t=new ActionReference,c=charIDToTypeID("Lyr ");t.putIdentifier(c,e),a.putReference(n,t);var o=stringIDToTypeID("selectionModifier"),i=stringIDToTypeID("selectionModifierType"),s=stringIDToTypeID("addToSelection");a.putEnumerated(o,i,s);var D=charIDToTypeID("MkVs");a.putBoolean(D,!1),executeAction(r,a,DialogModes.NO)}function renameActiveLayer(e){var r=charIDToTypeID("setd"),a=new ActionDescriptor,n=charIDToTypeID("null"),t=new ActionReference,c=charIDToTypeID("Lyr "),o=charIDToTypeID("Ordn"),i=charIDToTypeID("Trgt");t.putEnumerated(c,o,i),a.putReference(n,t);var s=charIDToTypeID("T   "),D=new ActionDescriptor,T=charIDToTypeID("Nm  ");D.putString(T,e);var c=charIDToTypeID("Lyr ");a.putObject(s,c,D),executeAction(r,a,DialogModes.NO)}function selectLayer(e){var r=charIDToTypeID("slct"),a=new ActionDescriptor,n=charIDToTypeID("null"),t=new ActionReference,c=charIDToTypeID("Lyr ");t.putIdentifier(c,e),a.putReference(n,t);var o=charIDToTypeID("MkVs");a.putBoolean(o,!1),executeAction(r,a,DialogModes.NO)}function deselectLayers(){var e=stringIDToTypeID("selectNoLayers"),r=new ActionDescriptor,a=charIDToTypeID("null"),n=new ActionReference,t=charIDToTypeID("Lyr "),c=charIDToTypeID("Ordn"),o=charIDToTypeID("Trgt");n.putEnumerated(t,c,o),r.putReference(a,n),executeAction(e,r,DialogModes.NO)}function determineNewName(e,r,a){if(a)return hasFlags(e)?e.substring(0,1).concat(r).concat(e.substring(1)):"-".concat(r).concat("-").concat(e);var n=e.indexOf(r),t=e.substring(0,n).concat(e.substring(n+1));return hasFlags(t)||(t=t.substring(2)),t}function hasFlags(e){var r="^-([a-z]+)-(.*)$",a=e.match(r);return null!==a}if(params.layers){for(var i=0;i<params.layers.length;i++){var layer=params.layers[i];renameLayer(layer.id,layer.name,params.flag,params.add)}if(params.selection)for(var j=0;j<params.selection.length;j++)addToSelection(params.selection[j].id)}